MISSRec: Pre-training and Transferring Multi-modal Interest-aware Sequence Representation for Recommendation, Jinpeng Wang, ACM MM, 2023

é¡ºåºæ¨è(SR)æ ¹æ®ç”¨æˆ·çš„å†å²äº¤äº’åºåˆ—æ¥é¢„æµ‹ç”¨æˆ·æ½œåœ¨æ„Ÿå…´è¶£çš„é¡¹ç›®.

$s_i=[I_1,I_2,...,I_t]$é¢„æµ‹$I_{t+1}$,iæ˜¯ç¬¬iä¸ªç”¨æˆ·

å¯¹äºç¨€ç–IDå’Œä¸ä¸€è‡´çš„IDæ˜ å°„é™åˆ¶äº†æ¨¡å‹çš„å¯è½¬ç§»æ€§.å¹¶å¯¹å†·å¯åŠ¨é—®é¢˜å’Œæµè¡Œåº¦åå·®é—®é¢˜å¤„ç†ä¸ä½³.æœ¬æ–‡æå‡ºMISSRec,æ˜¯ç”¨äºSRçš„å¤šæ¨¡æ€é¢„è®­ç»ƒå’Œè¿ç§»å­¦ä¹ æ¡†æ¶.



ç”¨æˆ·ç«¯:Transformerçš„æ•è·åºåˆ—çº§å¤šæ¨¡æ€ç”¨æˆ·å…´è¶£encoder-å…´è¶£æ„ŸçŸ¥decoder

å€™é€‰é¡¹ç›®:åŠ¨æ€èåˆç”Ÿæˆè‡ªé€‚åº”é¡¹ç›®è¡¨ç¤º.

1.å¤šæ¨¡æ€ååŒå–å†³äºç”¨æˆ·è€Œä¸”æ˜¯åŠ¨æ€çš„.

2.ä¿¡æ¯å†—ä½™å¯èƒ½ä¼šå‹å€’åŸºæœ¬å…´è¶£(å¤§å¤šæ•°ç”¨æˆ·è¡Œä¸ºå€¾å‘äºåŒè´¨åŒ–å•†å“),å¹³ç­‰å¯¹å¾…ä¼šå¯¼è‡´é¢„æµ‹åå·®.



MISSRec ç”± 7 ä¸ªä¸»è¦ç»„ä»¶ç»„æˆï¼š

1.é€šç”¨å¤šæ¨¡æ€itemè¡¨å¾

a.ä½¿ç”¨å†»ç»“çš„BERTå’ŒViTæå–æ–‡æœ¬ç‰¹å¾$f^t=\phi^t(I)$å’Œè§†è§‰ç‰¹å¾$f^v=\phi^v(I)$.

b.ç‰¹å¾å¢å¼º,å¯¹æ–‡æœ¬å’Œè§†è§‰ç‰¹å¾å„åš2æ¬¡å¢å¼ºå¾—åˆ°$\tilde{F_i^t}.\tilde{F_i^{t'}}.\tilde{F_i^v}.\tilde{F_i^{v'}}$

2.ç‰¹å®šäºæ¨¡æ€çš„é€‚é…å™¨å¼¥åˆå·®å¼‚,è¿™ä¹ˆåšå…è®¸é¢„è®­ç»ƒä¹Ÿå¯ä»¥ç”¨äºå‚æ•°é«˜æ•ˆä¼ è¾“

$X_i=[\psi^t(\tilde{F_i^t});\psi^v(\tilde{F_i^v})]$

3.å¤šæ¨¡å¼å…´è¶£å‘ç°(MID)æ¨¡å—

å¯¹å†å²äº¤äº’åºåˆ—çš„itemé›†$\mathcal{X}=\{x_i\}_{i=1}^N$èµ°ğ‘˜-æœ€è¿‘é‚»çš„å¯†åº¦å³°å€¼èšç±»ç®—æ³•DPC-KNN

å¯¹äºç¬¬iä¸ªtokenåŸºäºk-æœ€è¿‘é‚»å¾—åˆ°å±€éƒ¨å¯†åº¦

$\rho_i=exp(-\frac{1}{k}\sum_{x_j \in kNN(x_i)}||x_i-x_j||^2_2)$â€‹

è¿›è€Œè®¡ç®—åˆ°å…¶å®ƒæ›´é«˜å±€éƒ¨å¯†åº¦çš„tokençš„æœ€å°è·ç¦»

$\sigma_i=min_{j :\rho_j>\rho_i}||x_i-x_j||_2^2,\exist j \space s.t. \rho_j>\rho_i$â€‹

æˆ–è€…å’Œå…¶å®ƒtokençš„æœ€å¤§è·ç¦»

$\sigma_i=max_j \space||x_i-x_j||_2^2,else$

æœ€åä½¿ç”¨$K_c$æœ€é«˜$\rho_i*\sigma_i$çš„è´¨å¿ƒä½œä¸ºå…´è¶£è¿œè¡Œ,å¹¶å¾—åˆ°æ¯ä¸ªtokençš„å…´è¶£åˆ†é….

æœ€åå»é‡å¾—åˆ°å…´è¶£åˆ†é…åºåˆ—$\beta_1,\beta_2,...,\beta_M$

token-å…´è¶£åˆ†é…å¯ä»¥é¢„å­˜å‚¨

4.ç»Ÿä¸€åºåˆ—å»ºæ¨¡å’Œå¤šæ¨¡æ€èåˆå…´è¶£åºåˆ—çš„å¤šæ¨¡æ€å…´è¶£æ„ŸçŸ¥åºåˆ—æ¨¡å‹

a.ç»™å®š$K_e$ä¸ªæ ‡å‡†encoderå¾—åˆ°å…´è¶£åºåˆ—$\beta$å¯¹åº”çš„ç¼–ç å…´è¶£åºåˆ—$\xi_1,\xi_2,...,\xi_M$â€‹

b.ç»™å®š$K_d$ä¸ªdecoder,ç¼–ç å…´è¶£åºåˆ—$\xi_1,\xi_2,...,\xi_M$ä¼šä½œä¸ºKå’ŒV

é€é¡¹ä½ç½®emb$p_i=[p_1,p_2,...,p_{L_i}]$æ·»åŠ åˆ°item token$X_i=[x_1,x_2,...,x_{L_i}]$ä½œä¸ºdecodeçš„query

$u_i=y_{L_i}$åè€…æ˜¯decode outputçš„æœ€åä¸€ä½

5.åŠ¨æ€èåˆçš„å€™é€‰é¡¹ç›®è¡¨å¾

å¯¹å€™é€‰é›†$I_k$èµ°2å¾—åˆ°$x_k^t.x_k^v$,å¯¹user$i$èµ°3.4å¾—åˆ°åºåˆ—è¡¨ç¤º$u_i$,è¿›è€Œè®¡ç®—å¾—åˆ°è‡ªé€‚åº”è¡¨å¾$v_k$,$\alpha>0$æ˜¯é‡è¦æ€§æƒé‡

$\Large {v_k=\frac{e^{\alpha \cdot<u_t,x_k^t>  }\cdot x^t_k+e^{\alpha \cdot <u_i,x^v_k> }\cdot x^v_k}{e^{\alpha \cdot <u_i,x_k^t>  }+e^{\alpha \cdot <u_i,x_k^v>  }}}$

ä»¤$s^t_{i,k}=<u_i,x_k^t>,s_{i,k}^v=<u_i,x_k^v>$,æœ‰åœ¨mean poolingå’Œmax poolingç›´æ¥çš„å¯åˆ†è§£çš„èåˆåŒ¹é…åˆ†:

$\Large {<u_i,v_k>=\frac{s^t_{i,k}\cdot e^{\alpha \cdot s^t_{i,k} }+s^v_{i,k}\cdot e^{\alpha \cdot s^v_{i,k} }}{e^{\alpha \cdot s^t_{i,k} }+e^{\alpha \cdot s^v_{i,k}  }}}$

6.è‡ªç›‘ç£å¯¹æ¯”å­¦ä¹ é¢„è®­ç»ƒ

a.åºåˆ—-itemå¯¹æ¯”å­¦ä¹ 

$\Large {t_i^{S-I}=-log\frac{exp(<u_i,v_{T_i+1}>/\tau)}{\sum^B_{j=1}exp(<u_i,v_{T_j+1}>/\tau)}}$

æ¸©åº¦ç³»æ•°$\tau >0$,$B$æ˜¯mini-batchçš„æ•°é‡

b.åºåˆ—-åºåˆ—å¯¹æ¯”å­¦ä¹ 

$\Large {t_i^{S-S}=-log\frac{exp(<u_i,u_i'>/\tau)}{\sum^B_{j=1}exp(<u_i,u_j>/\tau)+exp(<u_i,u^{'}_{j}>/\tau)}}$â€‹

è·Ÿæ–‡æœ¬å¢å¼ºçš„åºåˆ—æ‹‰è¿‘

c.é¢„è®­ç»ƒæ€»loss

![image-20240313140001686](C:\Users\SFC\AppData\Roaming\Typora\typora-user-images\image-20240313140001686.png)

$\mathcal{L}_{pre-train}=\frac{1}{B}\sum^B_{i=1}[t_i^{S-I}+\lambda \cdot t_i^{S-S}+\frac{\gamma}{M_i^2}\sum^{M_i}_{m,m'=1}<\xi_m,\xi_{m'}>] \space\lambda,\gamma>0$

æœ€åä¸€é¡¹æ˜¯ä½¿å¾—decoderå…´è¶£å¤šæ ·åŒ–çš„æ­£äº¤æ­£åˆ™åŒ–

7.é¢„è®­ç»ƒå’Œä¸‹æ¸¸å¾®è°ƒä»»åŠ¡ä»¥å®ç°å¯è½¬ç§»çš„æ¨è

![image-20240313140047002](C:\Users\SFC\AppData\Roaming\Typora\typora-user-images\image-20240313140047002.png)

a.é«˜æ•ˆfine-tuneç›´æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªitem,åæ­£å°±æ˜¯ä¸€å¥è¯:å“ªé‡Œä¸ç”¨å†»å“ªé‡Œ.

$\mathcal{L}_{fine-tune}=\frac{1}{B}\sum^B_{i=1}[t_i^{S-I}+\frac{\gamma}{M_i^2}\sum^{M_i}_{m,m'=1}<\xi_m,\xi_{m'}>] \space\gamma>0$

b.å†·å¯åŠ¨ç›®æ ‡åŸŸçš„å½’çº³è¿ç§»

$P_{r_{ind}}(I_{T_{i+1}}|I_1,I_2,...,I_{T_{i}})=softmax(<u_i,v_{T_{i+1}}>)$â€‹

c.æš–å¯åŠ¨ç›®æ ‡åŸŸçš„ç›´æ¨è¿ç§»

$P_{r_{trd}}(I_{T_{i+1}}|I_1,I_2,...,I_{T_i})=softmax(<\bar{u_i},v_{T_{i+1}}+{z_{T_{i+1}}}>)$â€‹

$z_{T_{i+1}}$æ˜¯$I_{T_{i+1}}$çš„ID emb,$\bar{u_i}$æ˜¯itemåºåˆ—IDçš„encodeåºåˆ—è¡¨å¾







